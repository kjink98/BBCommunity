<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<meta charset="UTF-8">
	<title>Insert title here</title>
</head>

<body>
	<h1>게시글 상세보기</h1>
	<div>
		<ul>
			<li><a th:href="@{/}">메인</a></li>
			<li><a th:href="@{/post/all}">전체게시판</a></li>
			<li><a th:href="@{/post/free}">자유게시판</a></li>
			<li><a th:href="@{/post/notice}">공지사항</a></li>
		</ul>
	</div>
	<!-- Optional 객체를 Posts 객체로 추출하여 사용 -->
	<div th:if="${post != null}">
		<h2>제목: <span th:text="${post.title}"></span></h2>
		<p>작성자: <span th:text="${post.user.name}"></span></p>
		<p>내용: <span th:text="${post.content}"></span></p>
		<p>등록일: <span th:text="${#temporals.format(post.postRegdate, 'yyyy-MM-dd HH:mm:ss')}"></span></p>
		<p>조회수: <span th:text="${post.postViews}"></span></p>
	</div>
	<div th:unless="${post != null}">
		<p>해당 게시글을 찾을 수 없습니다.</p>
	</div>


	<form th:action="@{/post/edit/{id}(id=${post.postId})}" method="get">
		<button type="submit">수정하기</button>
	</form>
	<form th:action="@{/post/delete/{id}(id=${post.postId})}" method="post">
		<button type="submit">삭제하기</button>
	</form>

	<!-- 댓글 목록 -->
	<div>
		<h2>댓글 목록</h2>
		<div th:each="comment : ${comments}">
			<p>작성자: <span th:text="${comment.user.name}"></span></p>
			<p>내용: <span th:text="${comment.commentContent}"></span></p>
			<p>작성일: <span th:text="${#temporals.format(comment.commentRegdate, 'yyyy-MM-dd HH:mm:ss')}"></span></p>
			<!-- 댓글 삭제 버튼 -->
			<form th:action="@{/comments/delete}" method="post">
				<input type="hidden" th:name="commentId" th:value="${comment.commentId}" />
				<input type="hidden" th:name="postId" th:value="${post.postId}" />
				<button type="submit">댓글 삭제</button>
			</form>
		</div>
	</div>

	<!-- 댓글 작성 폼 -->
	<div>
		<h2>댓글 작성</h2>
		<form th:action="@{/comments/add}" method="post">
			<input type="hidden" th:name="postId" th:value="${post.postId}" />
			<label for="commentContent">댓글 내용:</label><br>
			<textarea id="commentContent" name="commentContent" rows="4" cols="50"></textarea><br>
			<button type="submit">댓글 작성</button>
		</form>
	</div>

	<button onclick="goBack()">뒤로 가기</button>

	<script>
		function goBack() {
			window.history.back(); // 브라우저 뒤로 가기 기능
		}
	</script>
</body>

</html>